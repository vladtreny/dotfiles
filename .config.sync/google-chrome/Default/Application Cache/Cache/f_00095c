function v4b(a,b,c,d){var e=null;a.B.every(function(a,h,k){if(b&&(h>c||h==c&&k>=d))return!1;a.isEmpty()||(e=new N(k,h));return!0});return e}function w4b(a,b,c){var d=null;a.B.some(function(a,f,h){return(f>b||f==b&&h>c)&&!a.isEmpty()?(d=new N(h,f),!0):!1});return d}YJ.prototype.jta=OR(161,function(a,b,c,d){for(var e=a-1,f=this.C.length;0<=e;){var h=this.C[e--];if(!(h.getSheetType()!=b||h.F&&d))return h}if(!c)return null;for(e=f-1;e>=a;)if(c=this.C[e--],!(c.getSheetType()!=b||c.F&&d))return c;return null});
sj.prototype.Vs=OR(31,function(){return!!Kh(this,"ip")});function x4b(a,b){var c=Cu(a.C);Rb(a.X,function(a,e){var f=this.J.Yo(a);Number(e)==c&&b?fo(f,"docs-icon-comment-blank-highlighted"):ho(f,"docs-icon-comment-blank-highlighted")},a)}function y4b(a,b,c){var d=0,e=-1;b&&(d=b.y,e=b.x);var f=null;return f=c?v4b(a,!!b,d,e):w4b(a,d,e)}function z4b(a,b){if(!b)return null;var c=null;a.B.some(function(a,e,f){a=a.Vc();for(var h=0;h<a.length;h++)if(a[h]==b)return c=new N(f,e),!0;return!1});return c}
function A4b(a){var b=new Wf;a.B.forEach(function(a){a.isEmpty()||Xf(b,a.Vc())});return b.Vc()}function B4b(a,b){var c=a.B.Ae(b.y,b.x);return c?c.Vc():[]}function f0(a){return a.B.hasUnpostedDocos()}function C4b(a,b){for(var c=[],d=0;d<b.length;d++)c.push(a.C.B[b[d]]||0);a.B.deleteDocoPositions(c)}function D4b(a,b){var c={},d;for(d in b){var e=a.C.B[d]||0;if(e&&a.B.hasDoco(e)){var f=b[d];c[e]=new Docos.Point(f.x,f.y)}}return c}var E4b={lRb:1,HOVER:2,nKa:3};
function g0(a,b,c){Nw.call(this,10100,b);this.bb=a;this.C=b;this.F=c}y(g0,Nw);g0.prototype.Vd=p(35);g0.prototype.Rd=function(){var a=new ew,b=hh(this.F,this.C);F(a,1,this.bb);F(a,2,b);return a};g0.prototype.cj=of;function F4b(a){this.B={};if(a)for(var b in a)this.set(b,a[b])}F4b.prototype.get=function(a){if(!(a in this.B))throw Error("No value for key "+a);return this.B[a]};F4b.prototype.set=function(a,b){this.B[a]=b};function G4b(a){this.B=new F4b;this.C=a||null}G4b.prototype.Nc=function(a){try{var b=oi(a)}catch(c){return this.C&&this.C.log(Error("Invalid serialized anchor ID")),null}return this.B.get(b.type).Nc(b)};G4b.prototype.Lb=function(a){return qi(this.B.get(a.getType()).Lb(a))};function h0(a,b){this.D=a;this.C=b}h0.prototype.getType=g("D");function H4b(a){h0.call(this,"range",0);this.F=a}y(H4b,h0);H4b.prototype.B=g("F");function I4b(){}ja(I4b);I4b.prototype.Nc=function(a){return new H4b(a.range)};I4b.prototype.Lb=function(a){var b={};b.type=a.getType();b.uid=a.C;b.range=a.B();return b};function i0(a,b){h0.call(this,"workbook-range",0);this.G=a;this.F=!!b}y(i0,h0);i0.prototype.B=g("G");function J4b(){}ja(J4b);J4b.prototype.Nc=function(a){return new i0(a.range)};J4b.prototype.Lb=function(a){var b={};b.type=a.F?"range":"workbook-range";b.uid=a.C;b.range=a.B();return b};function j0(){G4b.call(this);var a=I4b.getInstance();this.B.set("range",a);a=J4b.getInstance();this.B.set("workbook-range",a)}y(j0,G4b);ja(j0);j0.prototype.Nc=function(a){a=j0.P.Nc.call(this,a);if(!a)return null;"range"==a.getType()&&(a=new i0(a.B(),!0));return a};function k0(a,b){if(!b)return null;var c=b.B();return"range"==b.getType()?(c=a.B[c],K4b(c)?c.jc().ke():null):(c=L4b(b))&&M4b(N4b(c))?N4b(c).ke():null}function L4b(a){var b=new hi,c;try{c=ritz.getWorkbookRangeById(a.B(),!0)}catch(d){}return c?b.Nc((new Hd).ma(),ritz.getWorkbookRangeById(a.B(),!0)):null}function N4b(a){return new Ng(a.Pb(),a.Hb(),a.Bc(),a.Gc())}
function l0(a,b,c){return c?"range"==c.getType()?(b=b.B[c.B()],K4b(b)?(b=b.Ob(),null!=b?O4b(a,b):null):null):(b=L4b(c))&&M4b(N4b(b))?O4b(a,parseInt(b.Ta(),10)):null:null}function O4b(a,b){var c=Cz(a,b);return c?c.yc():null}function K4b(a){return!!a&&a.B&&M4b(a.jc())}function M4b(a){return!!a&&sga(a)&&ah(a)};function P4b(a,b,c,d,e,f,h,k,l,m,n){G.call(this);this.C=a;this.Ka=b;this.T=c;this.Ia=d;this.J=e;this.Ga=f;this.Y=h;this.Ca=k;this.B=l;this.X=m;this.G=b.Ka;this.D=b.B;this.F=b.L;this.K=j0.getInstance();this.R={};this.O=new Wf;this.va=new lk(0);a=[this.va];Eb(n.C,a);uxa(n,a);n.B=sxa(n.C);txa(n);this.L=new M(this);I(this,this.L);Q4b(this)}y(P4b,G);r=P4b.prototype;r.Wfa=!1;
function Q4b(a){var b=lb(kBa,function(a){return!nBa[a]});a.L.M(a.Ia,"activity-box-closed",a.f4a).M(a.J,"mouseover",m0(a,a.Pab)).M(a.J,"click",m0(a,a.Nab)).M(a.J,"selectionChange",m0(a,a.Qab)).M(a.J,"inputBoxActivate",m0(a,a.Lab)).M(a.J,"hide_docos",m0(a,a.Oab)).M(a.D,"Ta",m0(a,a.Qrb)).M(a.Y,"view-comments",a.Z8a).M(a.Y,"comment-indicator-hover-start",a.X8a).M(a.Y,"comment-indicator-hover-end",a.W8a).M(a.J,"insert_doco",a.Nrb).M(new pr(a.Ca),"mousewheel",a.Orb).M(a.F,["add_named_range","delete_named_range"],
a.R4a).M(a.Ka,"docos_change",a.$ab).M(a.X,"gf",a.gWa).M(a.D,"Sa",a.lxa);var c=Gu(a.D);a.L.M(c,b,a.Mab);a.L.M(c,["Ib"],m0(a,a.Prb));wD(a.C,Docos.EventType.HOVER,m0(a,a.VZa));wD(a.C,Docos.EventType.SELECTED,m0(a,a.Mrb));wD(a.C,Docos.EventType.CREATED,a.Ova,a);wD(a.C,Docos.EventType.UNRESOLVED,a.Ova,a);wD(a.C,Docos.EventType.DELETED,a.Pva,a);wD(a.C,Docos.EventType.RESOLVED,a.Pva,a);wD(a.C,Docos.EventType.POSTED,a.u_a,a);wD(a.C,Docos.EventType.PENDING,a.b6a,a);wD(a.C,Docos.EventType.HIGHLIGHT_INITIAL_DOCO,
a.E1a,a);Z.Do.Oc(Nm,v(a.q2a,a));R.Sv.Oc(Nm,v(a.RVa,a));R.h4.subscribe("action",v(a.D4a,a));R.i4.subscribe("action",v(a.M4a,a));R.j4.subscribe("action",v(a.N4a,a));a.lxa()}r.lxa=function(){var a=Hu(this.D);R.h4.Da(a);R.i4.Da(a);R.j4.Da(a)};r.q2a=function(){this.C.setOption(Docos.OptionName.READONLY,!this.Ka.JC())};function m0(a,b){return v(function(a){this.Wfa||b.call(this,a)},a)}
r.Nrb=function(){var a=Iu(this.D),b=mv(a);if(b&&!f0(this.C)&&!R4b(this,a,b)){var c=ritz.getNewWorkbookRangeId();this.Ga.B(new g0(c,a.Ob(),Pg(b)));a=this.K.Lb(new i0(c));if(a=n0(this,a))this.B.dispatchEvent(new o0("pf",[a],b)),this.T.Ac(2)}};function R4b(a,b,c){c=B4b(VC(a.G,b),c);return c.length?(b=a.C,a=a.K.Lb(c[0]),b.B.highlightDoco(b.C.B[a]||0,!0),!0):!1}r.Ova=function(a){z(a.B,function(a){p0(this,!0,a);this.O.add(a)},this)};r.Pva=function(a){z(a.B,function(a){p0(this,!1,a);this.O.remove(a)},this)};
function p0(a,b,c,d,e){c=n0(a,c);d=d||l0(a.D,a.F,c);e=e||k0(a.F,c);if(c&&d&&e){var f=VC(a.G,d);if(b){var h=f.B.Ae(e.y,e.x)||new Wf;h.add(c);Fy(f.B,e.y,e.x,h)}else(h=f.B.Ae(e.y,e.x))&&h.remove(c);Fy(f.C,e.y,e.x,!0);f.F.xb()||f.F.start();a.D.getActiveGrid()&&(d=d==Iu(a.D),b?(a=a.B,(b=d?e:null)&&Bg(b,a.aK)&&a.B.add(c),a.dispatchEvent(new o0("hf",[c],b))):(a=a.B,(b=d?e:null)&&Bg(b,a.aK)&&a.B.remove(c),a.Kr==c&&(a.Kr=null),a.dispatchEvent(new o0("rf",[c],b))))}else a.B.dispatchEvent("tf")}
function n0(a,b){if(!b)return null;if(!a.R[b]){var c=a.K.Nc(b);c&&(a.R[b]=c)}return a.R[b]}r.Qrb=function(){this.B.reset()};r.VZa=function(a){a=n0(this,a.B.length?a.B[0]:null);var b=k0(this.F,a);this.B.dispatchEvent(new o0("mf",[a],b))};r.u_a=ca();r.b6a=function(){var a=this.va,b=this.C.B.hasPendingContent();mk(a,kk(a.Fa,4,b))};r.E1a=function(a){this.Ia&&(a.D||this.B&&!this.B.Kr)&&this.Ia.C.setVisible(!0)};r.f4a=function(){this.T.Ac(3)};
r.Mrb=function(a){if(!f0(this.C)){var b=n0(this,a.B.length?a.B[0]:null),c=k0(this.F,b);b&&c?(this.Wfa=!0,S4b(this.B,b,c)):b||a.D?this.B.reset():b||this.T.Ac(3)}};r.gWa=function(){this.Wfa=!1};r.Oab=function(){this.B.dispatchEvent("of")};r.Qab=function(){if(!this.X.isEmpty()&&!f0(this.C)){this.T.Ac(3);var a=this.B,b=mv(Iu(this.D));Bg(a.LL,b)||!a.Kr&&!a.hv&&Bg(a.aK,b)||(q0(a),a.dispatchEvent(new o0("lf",[],b)))}};
r.Nab=function(){var a=Iu(this.D);if(!f0(this.C)&&a){var b=VC(this.G,a),c=(a=mv(a))?B4b(b,a):[];c.length&&(b=this.B,c=c[0],Bg(b.LL,a)?(q0(b),b.dispatchEvent(new o0("jf",[],a))):b.dispatchEvent(new o0("jf",[c],a)))}};r.Lab=function(){f0(this.C)||this.B.reset()};r.Prb=function(){T4b(this.B)};r.Mab=function(){T4b(this.B)};
r.R4a=function(a){var b=a.Ue;if(b&&b.B)if(K4b(b)){var c;c=b.getId();c=this.K.Lb(new H4b(c));a="add_named_range"==a.type;if(!a||this.O.contains(c)){var d=b.Ob();b.Ef()&&null!=d&&(d=O4b(this.D,d))&&p0(this,a,c,d,b.jc().ke())}}else this.B.dispatchEvent("tf")};
r.$ab=function(a){a=a.docos||[];Hb(a);for(var b=0;b<a.length;b++){var c=this.K.Lb(new i0(a[b]));if(c){var d=n0(this,c),e;a:{e=this.G;if(d){var f=void 0;for(f in e.B){var h=e.B[f],k=z4b(h,d);if(k){e={Ra:h.yc(),ONa:k};break a}}}e=null}e?(p0(this,!1,c,e.Ra,e.ONa),p0(this,!0,c),this.B.dispatchEvent("tf")):this.O.contains(c)&&p0(this,!0,c)}}};
r.Pab=function(a){var b=Iu(this.D);if(b){if((a=a.If)&&!JD(a)){var c=$z(b,a.y,a.x);a=c?c.ke():a}else a=null;b=VC(this.G,b);b=a?B4b(b,a):[];c=this.B;c.B.clear();Xf(c.B,b);c.aK=a;c.dispatchEvent(new o0("kf",b,a))}};r.Z8a=function(){if(!f0(this.C)){var a=this.B;if(a.hv&&a.rS)a.rS=!1;else{var b=!a.hv;q0(a);a.hv=b;a.dispatchEvent("qf")}}};r.X8a=function(){if(!f0(this.C)){var a=this.B;a.hv||(q0(a),a.rS=!0,a.hv=!0,a.dispatchEvent("qf"))}};r.W8a=function(){if(!f0(this.C)){var a=this.B;a.hv&&a.rS&&(q0(a),a.dispatchEvent("qf"))}};
r.Orb=function(a){a.stopPropagation()};r.GTa=function(a){var b=n0(this,a);a=l0(this.D,this.F,b);if(!b||!a)return"";b=k0(this.F,b);a=nv(a,b).getDisplayValue();500<a.length&&(a=a.substring(0,499),a+="\u2026");return a};r.RVa=function(){var a;a=this.C;var b=a.B.getLinkedDoco();if(a=a.C.C[b]||null||"")(a=n0(this,a))?(b=k0(this.F,a),S4b(this.B,a,b)):R.Sv.Ub()};r.D4a=function(){var a=Iu(this.D);R4b(this,a,mv(a))};r.M4a=function(){U4b(this,!1)};r.N4a=function(){U4b(this,!0)};
function U4b(a,b){for(var c=V4b(a,b),d=$A(a.D),e=Iu(a.D),f=mv(e),h=VC(a.G,e),f=y4b(h,f,b),k=d;!f&&null!==k&&(k=c(k),e=k.yc(),h=VC(a.G,e),f=y4b(h,null,b),k=k.gf,k!=d););f&&null!==k&&(c=B4b(h,f)[0],ny(a.D,k,v(a.Rrb,a,e,c,f)))}function V4b(a,b){var c;c=b?v(a.D.jta,a.D):v(a.D.vZ,a.D);return function(a){return c(a,0,!0,!0)}}r.Rrb=function(a,b,c){S4b(this.B,b,c);KA(a,c)};
r.U=function(){delete this.J;delete this.Ca;delete this.K;delete this.R;delete this.C;delete this.G;delete this.L;delete this.F;delete this.Ga;delete this.D;delete this.Ka;J(this.va);delete this.va;J(this.X);delete this.X;J(this.B);delete this.B;P4b.P.U.call(this)};function o0(a,b,c){K.call(this,a);this.docos=b;this.G=b.length?b[0]:null;this.Gl=c||null}y(o0,K);function W4b(){L.call(this);this.B=new Wf}y(W4b,L);r=W4b.prototype;r.aK=null;r.LL=null;r.Kr=null;r.hv=!1;r.rS=!1;function S4b(a,b,c){q0(a);a.Kr=b;a.LL=c;a.dispatchEvent(new o0("nf",[b],c))}r.Vs=g("hv");function T4b(a){a.hv||a.Kr||q0(a);a.dispatchEvent("uf")}r.reset=function(){q0(this);this.dispatchEvent("sf")};function q0(a){a.aK=null;a.B.clear();a.LL=null;a.Kr=null;a.hv=!1;a.rS=!1}r.U=function(){delete this.aK;delete this.B;delete this.LL;delete this.Kr;W4b.P.U.call(this)};function X4b(a,b,c,d,e,f){KF.call(this,a,b,c,d,e,2,0,f)}y(X4b,KF);X4b.prototype.T=function(a){return OXa(this,a,"range-border cell-border waffle-docos-target-cell-border")};function Y4b(a,b,c,d,e,f,h){L.call(this);this.D=a;this.Ka=b;this.F=c;this.Ia=d;this.J=e;this.B=f;this.O=b.Ka;this.C=b.B;this.K=b.L;this.L=j0.getInstance();this.Y=h||yl();this.G=new Wf;this.R=new Wf;this.T=new Wf;this.X=new Wf;this.va=new M(this);I(this,this.va);Z4b(this);this.va.M(this.C,"Sa",this.Vrb).M(this.B,"kf",this.wXa).M(this.B,"lf",this.yXa).M(this.B,"jf",this.vXa).M(this.B,"mf",this.WZa).M(this.B,"nf",this.Srb).M(this.B,"uf",this.Urb).M(this.B,"sf",this.Trb).M(this.B,"pf",this.t_a).M(this.B,
"tf",this.K7a).M(this.B,"hf",this.UZa).M(this.B,"rf",this.XZa).M(this.B,"of",this.YZa).M(this.B,"qf",this.g6a);$4b(this)}y(Y4b,L);r=Y4b.prototype;r.Fu=null;r.X8="none";r.T0=500;r.iU=!1;r.YZa=function(){r0(this)};r.UZa=function(a){var b=a.G;b&&a5b(this,[b],!0);b5b(this,a.G)};r.XZa=function(a){var b=a.G;b&&c5b(this,[b]);b5b(this,a.G)};function b5b(a,b){var c=l0(a.C,a.K,b);if(c){var d=VC(a.O,c);Gdb(a.Ia,c.Ob(),A4b(d).length)}else d5b(a)}r.g6a=function(){r0(this);this.B.Vs()&&e5b(this)};r.yXa=function(){r0(this)};
r.vXa=function(a){if(a.G){var b=a.G;this.iU=!0;a=this.D;b=this.L.Lb(b);a.B.highlightDoco(a.C.B[b]||0,void 0);this.iU=!1}else r0(this)};r.Urb=function(){var a=this.B.Kr,b=this.G.isEmpty();this.B.Vs()?e5b(this):a?(f5b(this,[a]),b&&!this.G.isEmpty()&&(this.iU=!0,b=this.D,a=this.L.Lb(a),b.B.highlightDoco(b.C.B[a]||0,void 0),this.iU=!1)):b||r0(this)};r.Trb=function(){r0(this)};
function r0(a){a.G.clear();var b=a.D;b.B.flushDocoPositions(D4b(b,{}));b=a.D;b.B.highlightDoco(b.C.B[""]||0,void 0);S(a.J,!1);J(a.Fu);g5b(a);h5b(a);a.B.Vs()||i5b(a);j5b(a,a.B.Vs());$4b(a)}r.isEmpty=function(){return this.G.isEmpty()&&this.T.isEmpty()&&this.R.isEmpty()&&this.X.isEmpty()};function $4b(a){var b=hy(a.F);b&&(a.T0=GRa(b.B)/2,a.D.setOption(Docos.OptionName.MAX_DOCO_HEIGHT,a.T0))}function h5b(a){vc(a.T.Vc());a.T.clear()}function g5b(a){vc(a.R.Vc());a.R.clear()}
function i5b(a){z(a.X.Vc(),function(a){ho(a,"waffle-docos-target-cell-header")});a.X.clear()}r.wXa=function(a){this.B.Kr||this.B.Vs()||(a=a.docos,a.length?f5b(this,a,!0):k5b(this,!1))};function f5b(a,b,c){f0(a.D)||c5b(a,Zf(a.G,b).Vc());a5b(a,b,c)}function e5b(a){var b=Iu(a.C);b&&(b=VC(a.O,b),f5b(a,A4b(b),!0),l5b(a),m5b(a))}r.Srb=function(a){n5b(this,a.G,a.Gl)};
function n5b(a,b,c,d){var e=l0(a.C,a.K,b);if(e){var f=e.Ob();if(o5b(a,b)){var h=p5b(a,c);yy(Cz(a.C,f).D,v(e.Gq,e,h)).addCallback(function(){q5b(this,c)&&!h.equals(HA(e))?(OA(e,h),n5b(this,b,c,d)):(Oz(nv(e,c))&&PH(hy(this.F)).setVisible(!1),r5b(this,c),f5b(this,[b],!0),g5b(this),h5b(this),i5b(this),s5b(this,c),j5b(this,this.B.Vs()),d&&bk(function(){this.D.B.grabFocus()},0,this),this.dispatchEvent("gf"))},a)}else XJ(a.C,f,v(function(){this.D.B.grabFocus();n5b(this,b,c,!0)},a))}else a.dispatchEvent("gf")}
function r5b(a,b){var c=Iu(a.C),d=hy(a.F);if(!a.iU&&c&&d){var e=d.B,d=d.C,f=HC(e,"waffle",!1,!1),h=212;if(!e.Ab()){var k=Dl("docs-docos-activitybox");k&&Go(k)&&(h+=f.right-Eo(k).left)}k=t5b(a,b);h=k.x-f.right+h;f=k.y-f.bottom+a.T0;if(!(0>=h&&0>=f)){d=d.B.ke();for(d=Og(d.y,d.x,d.y,d.x);JRa(e,d).height<f;)d.height+=1;for(;JRa(e,d).width<h;)d.width+=1;e=d.height;d=d.width;PA(c,dLa(c,dA(c,GA(c),d,e)))}}}function q5b(a,b){var c=Iu(a.C);return yA(qy(c,"r"),b.y)&&yA(qy(c,"c"),b.x)}
function j5b(a,b){x4b(a.Ia,b)}function p5b(a,b){return $z(Iu(a.C),b.y,b.x)||Pg(b)}
r.WZa=function(a){if(!this.B.Vs()&&(g5b(this),o5b(this,a.G)&&(k5b(this,!0),this.B.Kr!=a.G))){var b=this.L.Lb(a.G),c=this.D;c.B.isDocoResolved(c.C.B[b]||0)?(b=a.Gl,a=hy(this.F),(c=Iu(this.C))&&a&&b&&(b=$z(c,b.y,b.x)||Pg(b),b=yX(a,b,"waffle-docos-target-cell-resolved-rect"),hE(OH(a),b,!0),b.setVisible(!0),this.R.add(b))):(c=a.Gl,a=hy(this.F),(b=Iu(this.C))&&a&&c&&(c=$z(b,c.y,c.x)||Pg(c),b=new X4b(b,a.J,a.B,a.C,new bE(c),this.Y),hE(OH(a),b,!0),this.R.add(b),b.setVisible(!0)))}};
function u5b(a,b){b&&(fo(b,"waffle-docos-target-cell-header"),a.X.add(b))}function s5b(a,b){var c=hy(a.F),d=Iu(a.C);d&&c&&b&&(d=$z(d,b.y,b.x)||Pg(b),d=yX(c,d,"waffle-docos-target-cell-rect"),hE(OH(c),d,!0),a.T.add(d),d.setVisible(!0),d.getElement()&&a.va.M(d.getElement(),["click","contextmenu","dblclick","mousedown","mouseup"],function(a){a.If=b;c.dispatchEvent(a)}))}function l5b(a){h5b(a);var b={};z(a.G.Vc(),function(a){a=k0(this.K,a);var d=a.x+"-"+a.y;b[d]||(s5b(this,a),b[d]=!0)},a)}
function m5b(a){i5b(a);var b=Iu(a.C),c=hy(a.F);if(b&&c){var d=c.J,c=c.C,b=VC(a.O,b),e=c.Nf("r"),f=c.Xf("r"),h=c.Nf("c"),k=c.Xf("c");z(A4b(b),function(a){a=k0(this.K,a);a.x>=h&&a.x<=k&&u5b(this,d.B.getElement(DE(d,"ch-",null,WA(d.D,a.x))));a.y>=e&&a.y<=f&&u5b(this,d.B.getElement(DE(d,"rh-",VA(d.D,a.y),null)))},a)}}r.K7a=function(){d5b(this)};function d5b(a){var b=mb(Yb(a.O.B),Number);z(b,function(a){var b=O4b(this.C,a);b&&(b=VC(this.O,b),Gdb(this.Ia,a,A4b(b).length))},a)}
r.t_a=function(a){if(a.G){var b=this.L.Lb(a.G),c=this.D;a=t5b(this,a.Gl);a=u(a)?new Docos.Point(a.x,a.y):void 0;c.B.newDoco(b,a,void 0)}};
function a5b(a,b,c){for(var d={},e=[],f={},h=0;h<b.length;h++){var k=b[h],l=a.L.Lb(k),m;m=a;var n=k;if(hy(m.F)&&o5b(m,n)){var q=k0(m.K,n);m=v5b(m,p5b(m,q))?m.B.Vs()||m.B.Kr==n||sb(m.B.B.Vc(),n):!1}else m=!1;m?(m=k0(a.K,k),n=m=p5b(a,m),n=n.Pb()+"-"+n.Bc()+"-"+n.Hb()+"-"+n.Gc()+"-"+n.B+"-"+n.Dd,f[n]=f[n]||0,d[l]=t5b(a,m.ke(),f[n]),f[n]++,a.G.add(k)):e.push(k)}a.G.isEmpty()||k5b(a,!0);bc(d)||(b=a.D,b.B.updateDocoPositions(D4b(b,d)));f0(a.D)||c5b(a,e);if(c)for(c=a.G.Vc(),d=0;d<c.length;d++){e=a;b=c[d];
f=void 0;a:switch(f=b,f.getType()){case "range":break a;case "workbook-range":break a;default:throw Error("Invalid doco with type: "+f.getType());}f=k0(e.K,f);f=t5b(e,f);l=hy(e.F);h=l.B;k=l.$g;k=k.D(k.C()-1);m=Iu(e.C).L.y;l=l.C.Xf("r");h=h.ef(new Dg(m,l),"r");h+=k;k=yC(hy(e.F).B,"c");f=h-(f.y-k);f<e.T0&&b&&(b=e.L.Lb(b),e=e.D,e.B.setDocoMaxHeight(e.C.B[b]||0,125>f?125:f))}}
function c5b(a,b){var c=Yf(a.G,b).Vc();a.G.hc(c);c=mb(c,function(a){return this.L.Lb(a)},a);c.length&&C4b(a.D,c);a.G.isEmpty()&&k5b(a,!1)}
function t5b(a,b,c){var d=hy(a.F),e=Iu(a.C),f=d.B,h=f.Ab(),k=p5b(a,b),l=JC(f,k),m=c?15*c:0;c=h?l.left-m:l.right+m;var k=l.top+m,n=a.B.Vs();a=Bg(a.B.LL,b);var q=Oz(nv(e,b));n||a||!q?(b=k+125,0<b-GRa(f)&&(e=e.Aj("r")-1,f.Ul(b,"r","waffle")>=e&&(k-=50))):(a=PH(d),n=a.K,N1a(d,DA(e,b).ke()),e=a.R.height?a.Wb:0,b=a.T.height,d=Math.min(qVa.height,e+b),b&&(d=d+30+12+ME.top,d+=ME.bottom),e&&(d+=12,d+=ME.top,d+=ME.bottom),e=d,PD(a,n),k+=e);l=h?l.right+m+212:l.left-m-212;m=h?0>c-212:c+212>zC(f);e=h?l>zC(f):
0>l;m&&!e&&(c=l);return new N(h?AC(f,c,"c"):c,k)}function o5b(a,b){var c=l0(a.C,a.K,b),d=Iu(a.C);return!!c&&c==d}function v5b(a,b){if(!b)return!1;var c=hy(a.F).C,d=!1,e=b.ke();xga(b,function(a,b){var k;if(k=a==e.y)k=null!=KH(c,new N(b,a));return k?d=!0:!1});return d}r.Vrb=function(){Z4b(this)};function Z4b(a){var b=hy(a.F);b&&(a.Y.appendChild(b.hH,a.J),a.D.setOption(Docos.OptionName.LAYOUT_RTL,b.B.Ab()),a.D.setOption(Docos.OptionName.ANCHOR_DIV,a.J),a.D.B.renderAnchorSurface())}
function k5b(a,b){var c,d=a.J.style;c="";"opacity"in d?c=d.opacity:"MozOpacity"in d?c=d.MozOpacity:"filter"in d&&(d=d.filter.match(/alpha\(opacity=([\d.]+)\)/))&&(c=String(d[1]/100));c=""==c?c:Number(c);c=ra(c)?1:c;Go(a.J)||(c=0);d=b&&1>c?"in":!b&&0<c?"out":"none";"none"==d?(J(a.Fu),S(a.J,b)):a.Fu&&1==a.Fu.Fa&&a.X8==d||(J(a.Fu),S(a.J,!0),a.Fu=new wt(a.J,c,"in"==d?1:0,250),a.X8=d,"out"==d&&$c(a.Fu,"finish",v(a.i0a,a)),a.Fu.play())}r.i0a=function(){r0(this);var a=hy(this.F);a&&pD(a)};
r.U=function(){delete this.F;delete this.J;delete this.L;delete this.D;delete this.G;delete this.B;delete this.O;delete this.Y;delete this.X8;delete this.va;delete this.K;delete this.C;delete this.Ka;J(this.Fu);delete this.Fu;h5b(this);g5b(this);i5b(this);Y4b.P.U.call(this)};function w5b(a,b,c,d,e,f){G.call(this);this.L=a;this.R=u(b)?b:!0;this.O=u(c)?c:1;this.D=new sQ(v(this.CPa,this),d||1E3,e||6E4,f);I(this,this.D);this.G=new bj(void 0,this);this.B=null;this.J=[];this.F="DCS_Callback"+String(x5b++);this.K=this.C=null}y(w5b,G);var x5b=0;r=w5b.prototype;r.f8=function(){this.B=null;this.D.stop();this.G.hb(this.J)};
r.lqa=function(a){a instanceof cj||(a instanceof NR&&3==a.code?this.f8():(this.B=null,this.J.push(a instanceof Error?a.message:""),0<this.O--?this.D.start():this.G.Id(this.J)))};r.kdb=function(){this.D.xb()||this.D.start();var a=new bj;gj(this.G,a);return a};
r.CPa=function(){if(this.R){this.C=new $V(this.L);this.C.Yg=1E4;var a=v(this.f8,this);ga(this.F,a,void 0);this.K=this.C.send({callback:this.F},void 0,v(this.lqa,this))}else this.B&&this.B.cancel(),this.B=TVb(this.L,"dcs_main_js",{timeout:1E4}),dj(this.B,this.f8,this.lqa,this)};r.U=function(){this.B&&this.B.cancel();this.G.cancel();fa[this.F]&&(fa[this.F]=ia);this.C&&this.K&&this.C.cancel(this.K);w5b.P.U.call(this)};function y5b(){var a;a=""+('<div class="docs-docos-activitybox" role="dialog" aria-label="'+Cq("Comment stream box.")+'"><div class="docs-docos-activitybox-inner"></div></div>');return nq(a)};function s0(a,b){T.call(this,b);this.B=a}y(s0,T);r=s0.prototype;r.e8=null;r.dP=null;r.SP=null;r.Bn=null;r.Nna=!1;r.Oa=function(){s0.P.Oa.call(this);var a=this.Z(),b=eq(y5b,{},{},a);this.oa=b;am(b,!0);this.dP=a.getElement("docs-docos-caret");this.e8=a.Sd("docs-docos-activitybox-inner",b);this.B&&(fo(b,"docos-enable-new-header"),fo(this.dP,"docos-enable-new-header"))};
r.Ea=function(){this.SP=new vn(this.getElement());this.SP.Jk("close-box",27);this.Bn=new dp(this.getElement(),"toggle_display");fp(this.Bn,!0);var a=this.Bn;ep(a);a.c0=!1;this.Bn.ora=!1;V(this).M(this.SP,"shortcut",this.l9a).M(this.Bn,"show",this.Zfb).M(this.Bn,"hide",this.Yfb).M(this.Bn,"beforeshow",this.Xfb).M(this.Bn,"beforehide",this.Wfb)};r.mb=g("e8");r.Zfb=function(){S(this.dP,!0);this.dispatchEvent("show")};r.Yfb=function(){S(this.dP,!1)};r.Xfb=function(){return this.dispatchEvent("beforeshow")};
r.Wfb=function(){return this.Nna?!1:this.dispatchEvent("hide")};r.setVisible=function(a){this.Bn.setVisible(a)};r.Ma=function(){return!!this.Bn&&this.Bn.Ma()};r.l9a=function(a){switch(a.C){case "close-box":this.setVisible(!1)}};r.U=function(){J(this.SP);delete this.SP;delete this.dP;delete this.e8;J(this.Bn);delete this.Bn;s0.P.U.call(this)};function z5b(a,b,c,d){L.call(this);this.D=c||new zl;this.B=a;this.L=!!b;this.C=new s0(this.B.isDocsStreamHeaderEnabled&&this.B.isDocsStreamHeaderEnabled(),this.D);this.V=new M(this);this.G=new et(void 0,void 0,!0,qt.getInstance());this.F=d||R.Fia;this.J=!1;this.K=lh(mh(),"docs-edll");this.B.onReady(v(this.dgb,this))}y(z5b,L);r=z5b.prototype;r.lz=null;r.Kxa=!1;r.render=ca();
r.dgb=function(){var a=this.D.getElement("docs-docos-commentsbutton");this.lz=lS(null);Np(this.lz,16);this.lz.Qa(a);lh(mh(),"docosUnreadCommentsEnabled")&&(this.B.setListener(Docos.EventType.UNREAD_COMMENTS,this.Cgb,this),this.B.setOption(Docos.OptionName.ENABLE_UNREAD_COMMENTS,!0),R.Sv.Oc(Pm,this.oLa,this));jt(this.G,this.lz,R.Sv,kt);R.Sv.Oc(Pm,this.jkb,this);this.C.render(a.parentNode.parentNode);S(this.C.getElement(),!1);R.Sv.Da(!0);this.B.setOption(Docos.OptionName.PANE_DIV,this.C.mb());this.B.setOption(Docos.OptionName.PANE_KB_DIV,
this.C.getElement());this.B.setOption(Docos.OptionName.ENABLE_LAZY_LOADING,this.K);var b;this.K?(b=this.B.getLinkedDoco(),b=!!b&&(!this.B.hasDoco(b)||this.B.isDocoResolved(b)||!this.B.getDocoPosition(b))):b=!0;b?(this.B.renderPaneSurface(),this.J=!0):this.B.isLinkedDocoDeleted()&&(b=Qq("This comment has been deleted.","info",!0),Oq.getInstance().postMessage(b));this.B.setListener(Docos.OptionName.DIALOG_OPENED,v(this.YAa,this));this.B.setListener(Docos.OptionName.DIALOG_CLOSED,v(this.YAa,this));this.B.setOption(Docos.OptionName.SORT_PANE,
!0);this.B.setOption(Docos.OptionName.STREAM_BUTTON,a);Docos.EventType.CREATE_DRAFT&&(this.B.setListener(Docos.EventType.CREATE_DRAFT,this.UNa,this),this.F.Oc(Nm,this.XAa,this),this.XAa(new npa("enabled",this.F.isEnabled(),!1)));this.L||this.B.setListener(Docos.EventType.NETWORK_ERROR,this.Sfb,this);this.V.M(this.C,["show","hide"],this.Aeb)};r.YAa=function(a){a=a.args.shouldOverrideHide()&&a.type==Docos.OptionName.DIALOG_OPENED;this.C.Nna=a};
r.XAa=function(a){this.B.setOption(Docos.OptionName.ENABLE_COMMENT_BUTTON,a.newValue)};r.UNa=function(a){this.C.setVisible(!1);var b=a.args.isInstantDoco()?R.rIa:this.F,c;if(a.args.isInstantDoco()){c=new Rm;var d=-1==a.args.getInstantDocoSpacerIndex();P(c,42,d?E4b.nKa:E4b.HOVER);c=An(Bn(new zn,c),31).Aa()}b.Ub(a.args,c)};r.jkb=function(){this.J||(this.B.renderPaneSurface(),this.J=!0);var a=this.C;a.Bn&&!$sa(a.Bn)&&a.Bn.setVisible(!0)};
function A5b(a,b){if(0>b)throw Error("Number of unread comments cannot be negative");Hp(a.lz,"docs-docos-commentsbutton-unread",0<b);var c=a.D.getElement("docs-docos-commentsbutton");a.D.xg(c,String(b))}r.Cgb=function(){var a=this.B.getUnreadCommentsCount();A5b(this,a)};r.oLa=function(){A5b(this,0);this.B.ackUnreadComments()};
r.Sfb=function(){if(!this.Kxa&&R.Ti.isEnabled()){if(this.B.hasPendingContent()){var a=Qq("Failed to post comment due to a network error.","warning",!0);Oq.getInstance().postMessage(a)}this.B.setOption(Docos.OptionName.FATAL_READONLY,!0);this.B.setOption(Docos.OptionName.SHOW_ERRORS,!0);R.Fia.Da(!1,"docos-fatal-reason");this.Kxa=!0}};r.Aeb=function(a){a="show"==a.type;this.B.isPaneSurfaceRendered()&&this.B.setOption(Docos.OptionName.SORT_PANE,!a);this.lz.zc(a);a?this.B.grabFocus():this.dispatchEvent("activity-box-closed")};
r.U=function(){J(this.lz);delete this.lz;J(this.V);delete this.V;J(this.C);delete this.C;J(this.G);delete this.G;delete this.B;z5b.P.U.call(this)};function B5b(){G.call(this)}y(B5b,qm);r=B5b.prototype;r.NSa=function(){return w5b};r.gTa=function(){return z5b};r.dTa=function(){return P4b};r.eTa=function(){return W4b};r.fTa=function(){return Y4b};ym("docos",B5b);
